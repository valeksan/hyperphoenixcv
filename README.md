# HyperPhoenixCV üê¶‚Äçüî•

> *"–í–æ–∑—Ä–æ–∂–¥–∞–π—Ç–µ—Å—å –∏–∑ –ø–µ–ø–ª–∞ –ø—Ä–µ—Ä–≤–∞–Ω–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤"*

HyperPhoenixCV - —ç—Ç–æ —É–º–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–π, –∫–∞–∫ –º–∏—Ñ–∏—á–µ—Å–∫–∏–π —Ñ–µ–Ω–∏–∫—Å, **–≤–æ–∑—Ä–æ–∂–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π** –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π. –ù–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–µ –Ω–µ —Ç–µ—Ä—è–π—Ç–µ —á–∞—Å—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏–∑-–∑–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫!

## –ü–æ—á–µ–º—É HyperPhoenixCV?

–ù–∞–∑–≤–∞–Ω–∏–µ **HyperPhoenixCV** –æ—Ç—Å—ã–ª–∞–µ—Ç –∫ –º–∏—Ñ–∏—á–µ—Å–∫–æ–º—É —Ñ–µ–Ω–∏–∫—Å—É ‚Äî –ø—Ç–∏—Ü–µ, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑—Ä–æ–∂–¥–∞–µ—Ç—Å—è –∏–∑ –ø–µ–ø–ª–∞. –¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –≤–∞—à –ø–æ–∏—Å–∫ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–∂–µ—Ç "–≤–æ–∑—Ä–æ–¥–∏—Ç—å—Å—è" –ø–æ—Å–ª–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è, –ø—Ä–æ–¥–æ–ª–∂–∞—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Ç–æ—á–∫–∏, –∞ –Ω–µ –Ω–∞—á–∏–Ω–∞—è –≤—Å—ë —Å–Ω–∞—á–∞–ª–∞.
CV –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–≤—è–∑—å —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## –û—Ç–ª–∏—á–∏—è –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ `GridSearchCV`:

### **–í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º–æ—Å—Ç—å**
–ü—Ä–µ—Ä–≤–∞–ª–∏—Å—å –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤? –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞ ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏!
```python
hp = HyperPhoenixCV(
    estimator=model,
    param_grid=param_grid,
    checkpoint_path="my_experiment.pkl"  # –ö–ª—é—á–µ–≤–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä!
)
hp.fit(X, y)  # –ü—Ä–µ—Ä–≤–∞–ª–∏? –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞ —Å —Ç–µ–º –∂–µ –ø—É—Ç–µ–º
```

### **–£–º–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
–ë–∞–π–µ—Å–æ–≤—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
```python
hp = HyperPhoenixCV(
    estimator=model,
    param_grid=param_grid,
    use_bayesian_optimization=True,
    verbose=True
)
```

### **–ì–∏–±–∫–æ—Å—Ç—å** 
–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä, —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ–∏—Å–∫ –∏–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ‚Äî –≤—ã–±–∏—Ä–∞–π—Ç–µ –ø–æ–¥—Ö–æ–¥. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏.
```python
hp = HyperPhoenixCV(
    estimator=model,
    param_grid=param_grid,
    random_search=True,
    n_iter=50  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–π–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
)
```
```python
hp = HyperPhoenixCV(
    estimator=model,
    param_grid=param_grid,
    scoring=['f1', 'accuracy', 'precision']
)
```

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**
–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —á–µ–∫–ø–æ–∏–Ω—Ç—ã –∏ CSV.
```python
hp = HyperPhoenixCV(
    estimator=model,
    param_grid=param_grid,
    results_csv="experiment_results.csv"  # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ CSV
)
```

### **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å scikit-learn API (–∞ –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ –ø–æ–ø—Ä–∞–≤–∏–º).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```python
from hyperphoenixcv import HyperPhoenixCV
from sklearn.pipeline import Pipeline
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression

# –°–æ–∑–¥–∞–µ–º –ø–∞–π–ø–ª–∞–π–Ω
pipeline = Pipeline([
    ('tfidf', TfidfVectorizer()),
    ('clf', LogisticRegression(max_iter=1000))
])

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–µ—Ç–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
param_grid = {
    'tfidf__max_features': [1000, 5000, 10000],
    'tfidf__ngram_range': [(1, 1), (1, 2)],
    'clf__C': [0.001, 0.01, 0.1, 1.0]
}

# –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º HyperPhoenixCV
hp = HyperPhoenixCV(
    estimator=pipeline,
    param_grid=param_grid,
    scoring='f1',
    cv=5,
    checkpoint_path="nlp_experiment.pkl",
    verbose=True
)

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
hp.fit(X_train, y_train)

# –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –±—ã–ª –ø—Ä–µ—Ä–≤–∞–Ω, –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
hp.fit(X_train, y_train)  # –ü—Ä–æ–¥–æ–ª–∂–∏—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Ç–æ—á–∫–∏!

# –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print("–õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:", hp.best_params_)
print("–õ—É—á—à–∏–π F1-—Å–∫–æ—Ä:", hp.best_score_)

# –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ø-5 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
top_results = hp.get_top_results(5)
print(top_results)
```

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ —Å–æ–æ–±—â–µ—Å—Ç–≤—É scikit-learn –∑–∞ –æ—Å–Ω–æ–≤—É, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —ç—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞.
